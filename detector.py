import pickle
import pandas as pd
from sklearn.preprocessing import LabelEncoder, OneHotEncoder
model = pickle.load(open("model.pickle.dat", "rb"))

le = LabelEncoder()

#while True:
# one hot encode string
labels = ["0", "1"]
incoming_str = ["6 6 63", "6 63 6"]
incoming_str_df = pd.DataFrame(incoming_str)
incoming_str_df = incoming_str_df.T
incoming_str_df.columns = labels
print(incoming_str)
incoming_str_df.apply(le.fit_transform)

# get prediction
pred = model.predict(incoming_str_df)
pred_val = round(pred)
if pred_val == 1:
    print("Malware detected.")
else:
    print("Malware not detected.")

